IF
  StateCheck(Myself,STATE_REALLY_DEAD)
THEN
    RESPONSE #100
             NoAction()
END

IF
	!HasItem("RZDISPCH",Myself) // Helma
THEN
	RESPONSE #100
		ApplySpellRES("RZDISPCH",Myself) // Helma
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",0)
		SetGlobalTimer("PfMW_Timer","LOCALS",0)
		SetGlobalTimer("Spell_Protection_Timer","LOCALS",0)
		Continue()
END

IF
	!GlobalTimerNotExpired("Chain_Contingency_Timer","LOCALS")
	DifficultyGT(EASY)
	See(NearestEnemyOf(Myself))
	Allegiance(Myself,ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		ApplySpellRES("RZDISPCH",Myself) // Helma
		SetGlobal("RZ_See_Enemy","LOCALS",1)
		SetGlobalTimer("Chain_Contingency_Timer","LOCALS",4800)
		DisplayString(Myself,26328) // ÿetÏzov· eventualita
		SmallWait(1)
		SetGlobalTimer("Invisibility_Timer","LOCALS",120)
		SetGlobal("Invisibility","LOCALS",1)
		ReallyForceSpell(Myself,WIZARD_MISLEAD)
		ReallyForceSpellRES("RZsimul",Myself)
		ReallyForceSpell(Myself,WIZARD_GLOBE_OF_INVULNERABILITY)
		SetInterrupt(TRUE)
		Continue()
END

IF
	!GlobalTimerNotExpired("Contingency_Timer","LOCALS")
	DifficultyGT(EASY)
	See(NearestEnemyOf(Myself))
	Allegiance(Myself,ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Contingency_Timer","LOCALS",4800)
		DisplayString(Myself,34586) // Contingency
		SetGlobalTimer("PfMW_Timer","LOCALS",24)
		SmallWait(1)
                ReallyForceSpell(Myself,WIZARD_MIRROR_IMAGE)
		SetInterrupt(TRUE)
		Continue()
END

IF
	!GlobalTimerNotExpired("Contingency_Timer","LOCALS")
	DifficultyLT(NORMAL)
	DifficultyGT(EASIEST)
	See(NearestEnemyOf(Myself))
	Allegiance(Myself,ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Contingency_Timer","LOCALS",4800)
		DisplayString(Myself,34586) // Contingency
		SetGlobalTimer("PfMW_Timer","LOCALS",24)
		SmallWait(1)
                ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		SetInterrupt(TRUE)
		Continue()
END

IF
	Global("Change_AI_Simul","LOCALS",0)
	See(SecondNearest([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE]))
	!LevelGT(LastSeenBy(Myself),24)
THEN
	RESPONSE #100
		SetGlobal("Change_AI_Simul","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),SetInterrupt(FALSE))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Action_Timer","LOCALS",6))
		ActionOverride(LastSeenBy(Myself),ChangeGender(Myself,NIETHER))
                ActionOverride(LastSeenBy(Myself),Spell(Myself,WIZARD_STONE_SKIN))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Contingency_Timer","LOCALS",4800))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Minor_Sequencer_Timer","LOCALS",4800))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Spell_Sequencer_Timer","LOCALS",4800))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Spell_Trigger_Timer","LOCALS",4800))
                ActionOverride(LastSeenBy(Myself),SetGlobalTimer("Spell_Protection_Timer","LOCALS",24))
		ActionOverride(LastSeenBy(Myself),ApplySpellRES("RZDISPCH",Myself)) // Helma
		ActionOverride(LastSeenBy(Myself),SetGlobal("RZ_Rest","LOCALS",1))
		ActionOverride(LastSeenBy(Myself),SetGlobalTimer("RZ_Rest_Timer","LOCALS",3600))
		ActionOverride(LastSeenBy(Myself),SetGlobal("RZ_See_Enemy","LOCALS",1))
		ActionOverride(LastSeenBy(Myself),SetGlobal("Change_AI_Simul","LOCALS",1))
                ActionOverride(LastSeenBy(Myself),RunAwayFrom(NearestEnemyOf(Myself),90))
                ActionOverride(LastSeenBy(Myself),ChangeAIScript("VA#USTRN",OVERRIDE)) 
                ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
                ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
                ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
                ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
                ActionOverride(LastSeenBy(Myself),SetInterrupt(TRUE))
END

IF
	Global("Change_AI","LOCALS",0)
	See([ENEMY.0.0.0.0.ILLUSIONARY])
THEN
	RESPONSE #100
		SetGlobal("Change_AI","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("WDRUNSGT",OVERRIDE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Spell_Sequencer_Timer","LOCALS")
	NumCreatureGT([PC],1)
	DifficultyGT(EASIEST)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(13)
	    See(NearestEnemyOf(Myself))
	    See([PC])
	    See(StrongestOf([PC]))
            See(SecondNearest([PC.0.0.CLERIC_ALL]))
            See([PC.0.0.CLERIC_ALL])
            See(SecondNearest([PC.0.0.MAGE_ALL]))
            See([PC.0.0.MAGE_ALL])
            See(SecondNearest([PC.0.0.SORCERER]))
            See([PC.0.0.SORCERER])
            See(SecondNearest([PC.0.0.CLERIC_RANGER]))
            See([PC.0.0.CLERIC_RANGER])
            See(SecondNearest([PC.0.0.DRUID_ALL]))
            See([PC.0.0.DRUID_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Spell_Sequencer_Timer","LOCALS",4800)
		SetGlobalTimer("Greater_Malison_Timer","LOCALS",240)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		DisplayString(Myself,25951) // Spell Sequencer
		SmallWait(1)
		ReallyForceSpell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)
		SmallWait(1)
		ReallyForceSpell(LastSeenBy(Myself),WIZARD_CONFUSION)
		SmallWait(1)
		ReallyForceSpellRES("va#otsph",LastSeenBy(Myself))
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Spell_Sequencer_Timer","LOCALS")
	DifficultyGT(EASIEST)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(13)
	    See(NearestEnemyOf(Myself))
	    See([PC])
	    See(StrongestOf([PC]))
            See(SecondNearest([PC.0.0.CLERIC_ALL]))
            See([PC.0.0.CLERIC_ALL])
            See(SecondNearest([PC.0.0.MAGE_ALL]))
            See([PC.0.0.MAGE_ALL])
            See(SecondNearest([PC.0.0.SORCERER]))
            See([PC.0.0.SORCERER])
            See(SecondNearest([PC.0.0.CLERIC_RANGER]))
            See([PC.0.0.CLERIC_RANGER])
            See(SecondNearest([PC.0.0.DRUID_ALL]))
            See([PC.0.0.DRUID_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Spell_Sequencer_Timer","LOCALS",4800)
		SetGlobalTimer("Greater_Malison_Timer","LOCALS",240)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		DisplayString(Myself,25951) // Spell Sequencer
		SmallWait(1)
		ReallyForceSpell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)
		SmallWait(1)
		ReallyForceSpell(LastSeenBy(Myself),WIZARD_SLOW)
		SmallWait(1)
		ReallyForceSpell(LastSeenBy(Myself),WIZARD_CONFUSION)
		SetInterrupt(TRUE)
END

IF
	Global("Change_AI_Skeleton","LOCALS",0)
	See([ENEMY.UNDEAD.SKELETON.SKELETON_WARRIOR])
THEN
	RESPONSE #100
		SetGlobal("Change_AI_Skeleton","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("VA#CRE01",OVERRIDE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
END

IF
	Global("Change_AI_Sword","LOCALS",0)
	See([ENEMY.WEAPON.SWORD])
THEN
	RESPONSE #100
		SetGlobal("Change_AI_Sword","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("VA#CRE01",OVERRIDE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
END

IF
	Global("Change_AI_Spider","LOCALS",0)
	See([ENEMY.MONSTER.SPIDER])
THEN
	RESPONSE #100
		SetGlobal("Change_AI_Spider","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("VA#CRE01",OVERRIDE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
END

IF
	Global("Change_AI_Planetar","LOCALS",0)
	See([ENEMY.0.DARKPLANATAR])
THEN
	RESPONSE #100
		SetGlobal("Change_AI_Planetar","LOCALS",1)
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("VA#FPLAN",OVERRIDE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",CLASS))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",RACE))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",GENERAL))
		ActionOverride(LastSeenBy(Myself),ChangeAIScript("",DEFAULT))
END

IF
	Global("RZ_Rest","LOCALS",0)
	OR(7)
		Detect([GOODCUTOFF.0.0.0.0.SUMMONED])
		Detect([PC])
		Detect([ALLY])
		Detect([CONTROLLED])
		Detect([CHARMED])
		Detect([FAMILIAR])
		Detect(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		SetGlobal("RZ_Rest","LOCALS",1)
		SetGlobalTimer("RZ_Rest_Timer","LOCALS",2400)
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Rest_Timer","LOCALS")
	!Detect([GOODCUTOFF.0.0.0.0.SUMMONED])
	!Detect([PC])
	!Detect([ALLY])
	!Detect([CONTROLLED])
	!Detect([CHARMED])
	!Detect([FAMILIAR])
	!Detect(NearestEnemyOf(Myself))
	CombatCounter(0)
THEN
	RESPONSE #100
		SetGlobalTimer("RZ_Rest_Timer","LOCALS",3600)
		SetGlobal("Change_AI_Planetar","LOCALS",0)
		SetGlobal("Change_AI_Sword","LOCALS",0)
		SetGlobal("Change_AI_Spider","LOCALS",0)
		SetGlobal("Change_AI_Skeleton","LOCALS",0)
		SetGlobal("Spell_Immunity","LOCALS",0)
		SetGlobal("Change_AI","LOCALS",0)
	        SetGlobal("Change_AI_Simul","LOCALS",0)
		SetGlobal("RZ_Rest","LOCALS",0)
		SetGlobal("Out_of_Spells","LOCALS",0)
		SetGlobal("Out_of_Area_Spells","LOCALS",0)
		ApplySpell(Myself,RESTORE_FULL_HEALTH)
		Rest()
END

IF
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
THEN
	RESPONSE #100
		SetGlobalTimer("PfMW_Timer","LOCALS",24)
		Continue()
END

IF
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SPELL_TURNING)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Protection_Timer","LOCALS",360)
		Continue()
END

IF
	Global("Invisibility","LOCALS",0)
	OR(2)
		SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SHADOW_DOOR)
		SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_MISLEAD)
THEN
	RESPONSE #100
		SetGlobalTimer("Invisibility_Timer","LOCALS",120)
		SetGlobal("Invisibility","LOCALS",1)
		Continue()
END

IF
	Global("Mirror_Image","LOCALS",0)
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_MIRROR_IMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",138)
		SetGlobal("Mirror_Image","LOCALS",1)
		Continue()
END

IF
	GlobalTimerNotExpired("Mirror_Image_Timer","LOCALS")
	!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
		Continue()
END

IF
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_TIME_STOP)
THEN
	RESPONSE #100
		SetGlobalTimer("Time_Stop_Timer","LOCALS",15)
		IncrementGlobal("Time_Stop","LOCALS",1)
		Continue()
END

IF
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SPELL_IMMUNITY_DIVINATION)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",120)
		Continue()
END

IF
	SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_DEATH_SPELL)
THEN
	RESPONSE #100
		SetGlobalTimer("Death_Spell","LOCALS",18)
		Continue()
END

IF
	GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	SpellCastOnMe([GOODCUTOFF],WIZARD_BREACH)
THEN
	RESPONSE #100
		SetGlobalTimer("PfMW_Timer","LOCALS",24)
		Continue()
END

IF
	GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	OR(6)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_THRUST)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Immunity_Divination","LOCALS",0)
		Continue()
END

IF
	GlobalTimerNotExpired("Spell_Protection_Timer","LOCALS")
	OR(5)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)
THEN
	RESPONSE #100
		SetGlobalTimer("Spell_Protection_Timer","LOCALS",0)
		Continue()
END

IF
	Global("Elemental_Attack","LOCALS",0)
	!SpellCastOnMe([GOODCUTOFF],0)
	AttackedBy([GOODCUTOFF],DEFAULT)
	OR(9)
		HitBy([GOODCUTOFF],ACID)
		HitBy([GOODCUTOFF],COLD)
		HitBy([GOODCUTOFF],ELECTRICITY)
		HitBy([GOODCUTOFF],FIRE)
		HitBy([GOODCUTOFF],POISON)
		HitBy([GOODCUTOFF],MAGIC)
		HitBy([GOODCUTOFF],MAGICFIRE)
		HitBy([GOODCUTOFF],MAGICCOLD)
		HitBy([GOODCUTOFF],STUNNING)
THEN
	RESPONSE #100
		SetGlobal("Elemental_Attack","LOCALS",1)
		Continue()
END

IF
	Global("Elemental_Attack","LOCALS",0)
	OR(6)
	     LevelGT([PC.0.0.MAGE_ALL],15)
	     LevelGT(SecondNearest([PC.0.0.MAGE_ALL]),15)
	     LevelGT(ThirdNearest([PC.0.0.MAGE_ALL]),15)
	     LevelGT(FourthNearest([PC.0.0.MAGE_ALL]),15)
	     LevelGT(FifthNearest([PC.0.0.MAGE_ALL]),15)
	     LevelGT(SixthNearest([PC.0.0.MAGE_ALL]),15)
THEN
	RESPONSE #100
		SetGlobal("Elemental_Attack","LOCALS",1)
		Continue()
END

IF
	Global("PC_Invisibility","LOCALS",0)
	!GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
	OR(10)
		SpellCast([GOODCUTOFF],WIZARD_PROJECT_IMAGE)
		SpellCast([GOODCUTOFF],WIZARD_MASS_INVISIBILITY)
		SpellCast([GOODCUTOFF],WIZARD_MISLEAD)
		SpellCast([GOODCUTOFF],WIZARD_SHADOW_DOOR)
		SpellCast([GOODCUTOFF],WIZARD_IMPROVED_INVISIBILITY)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY_10_FOOT)
		SpellCast([GOODCUTOFF],WIZARD_INVISIBILITY)
		SpellCast([GOODCUTOFF],WIZARD_MIRROR_IMAGE)
		SpellCastPriest([GOODCUTOFF],CLERIC_PIXIE_DUST)
		SpellCastPriest([GOODCUTOFF],CLERIC_SANCTUARY)
THEN
	RESPONSE #100
		SetGlobal("PC_Invisibility","LOCALS",1)
		Continue()
END

IF
	OR(4)
		SpellCast([GOODCUTOFF],WIZARD_TRUE_SIGHT)
		SpellCastPriest([GOODCUTOFF],CLERIC_TRUE_SIGHT)
		SpellCastInnate([GOODCUTOFF],HELM_TRUE_SIGHT)
		SpellCastInnate([GOODCUTOFF],INQUIS_TRUE_SIGHT)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","MYAREA",60)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	GlobalTimerNotExpired("Invisibility_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","MYAREA",60)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
END

IF
	!GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	GlobalTimerNotExpired("Mirror_Image_Timer","LOCALS")
	SpellCastInnate([GOODCUTOFF],0)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
THEN
	RESPONSE #100
		SetGlobalTimer("PC_True_Sight","MYAREA",60)
		SetGlobalTimer("Invisibility_Timer","LOCALS",0)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",0)
END

IF
	OR(8)
             SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_TIME_STOP)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_DEATH_SPELL)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SHADOW_DOOR)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_MISLEAD)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_MIRROR_IMAGE)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SPELL_TURNING)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
	     SpellCast([ENEMY.HUMANOID.GITHYANKI.MAGE.0.MALE],WIZARD_SPELL_IMMUNITY_DIVINATION)
THEN
	RESPONSE #100
		SetGlobal("RZ_RERUN","LOCALS",1)
END

IF
	GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	OR(6)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_THRUST)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)
THEN
	RESPONSE #100
		SetGlobal("RZ_RERUN","LOCALS",1)
END

IF
	GlobalTimerNotExpired("Spell_Protection_Timer","LOCALS")
	OR(5)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SECRET_WORD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_RUBY_RAY_OF_REVERSAL)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_WARDING_WHIP)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_PIERCE_SHIELD)
	     SpellCastOnMe([GOODCUTOFF],WIZARD_SPELL_STRIKE)
THEN
	RESPONSE #100
		SetGlobal("RZ_RERUN","LOCALS",1)
END

IF
  Global("See_Invisible","LOCALS",0)
  OR(10)
        !CheckStat(NearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(SecondNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(ThirdNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(FourthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(FifthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(SixthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(SeventhNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(EighthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(NinthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        !CheckStat(TenthNearestEnemyOf(Myself),0,SEEINVISIBLE)
THEN
    RESPONSE #100
             SetGlobal("See_Invisible","LOCALS",1)
END

IF
  Global("See_Invisible","LOCALS",1)
        CheckStat(NearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(SecondNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(ThirdNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(FourthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(FifthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(SixthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(SeventhNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(EighthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(NinthNearestEnemyOf(Myself),0,SEEINVISIBLE)
        CheckStat(TenthNearestEnemyOf(Myself),0,SEEINVISIBLE)
THEN
    RESPONSE #100
             SetGlobal("See_Invisible","LOCALS",0)
END

IF
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!HaveSpell(WIZARD_CHROMATIC_ORB)
	!HaveSpell(WIZARD_MAGIC_MISSILE)
	!HaveSpell(WIZARD_GLITTERDUST)
	!HaveSpell(WIZARD_MELF_ACID_ARROW)
	!HaveSpell(WIZARD_FLAME_ARROW)
	!HaveSpell(WIZARD_HOLD_PERSON)
	!HaveSpell(WIZARD_SKULL_TRAP)
	!HaveSpell(WIZARD_SLOW)
	!HaveSpell(WIZARD_CONFUSION)
	!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
	!HaveSpell(WIZARD_CONE_OF_COLD)
	!HaveSpell(WIZARD_CHAOS)
	!HaveSpell(WIZARD_CHAIN_LIGHTNING)
	!HaveSpell(WIZARD_FLESH_TO_STONE)
	!HaveSpell(WIZARD_FINGER_OF_DEATH)
	!HaveSpell(WIZARD_SUMMON_HAKEASHAR)
	!HaveSpell(WIZARD_MORDENKAINENS_SWORD)
	!HaveSpell(WIZARD_POWER_WORD_STUN)
	!HaveSpell(WIZARD_SPHERE_OF_CHAOS)
	!HaveSpell(WIZARD_PRISMATIC_SPRAY)
	!HaveSpell(WIZARD_SUN_FIRE)
	!HaveSpell(WIZARD_ANIMATE_DEAD)
	!HaveSpell(WIZARD_TELEPORT_FIELD)
	!HaveSpell(WIZARD_SPIDER_SPAWN)
	OR(2)
		Difficulty(EASIEST)
	        !HaveSpell(WIZARD_MAZE)
	OR(2)
		Difficulty(EASIEST)
		!HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	OR(2)
		Difficulty(EASIEST)
		!HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)
	OR(2)
		Difficulty(EASIEST)
                !HaveSpell(WIZARD_POWER_WORD_BLIND)
	OR(2)
	     Difficulty(EASIEST)
             GlobalTimerNotExpired("Spell_Sequencer_Timer","LOCALS")
      OR(2)
             DifficultyLT(NORMAL)
             !HaveSpell(WIZARD_DRAGONS_BREATH)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",1)
END

IF
	Global("Out_of_Area_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!HaveSpell(WIZARD_GLITTERDUST)
	!HaveSpell(WIZARD_SKULL_TRAP)
	!HaveSpell(WIZARD_SLOW)
	!HaveSpell(WIZARD_CONFUSION)
	!HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
	!HaveSpell(WIZARD_CONE_OF_COLD)
	!HaveSpell(WIZARD_CHAOS)
	!HaveSpell(WIZARD_SPHERE_OF_CHAOS)
	!HaveSpell(WIZARD_ANIMATE_DEAD)
	!HaveSpell(WIZARD_TELEPORT_FIELD)
	!HaveSpell(WIZARD_PRISMATIC_SPRAY)
	!HaveSpell(WIZARD_SUMMON_HAKEASHAR)
	!HaveSpell(WIZARD_SPIDER_SPAWN)
	OR(2)
		Difficulty(EASIEST)
		!HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	OR(2)
             DifficultyLT(NORMAL)
             !HaveSpell(WIZARD_DRAGONS_BREATH)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",1)
END

IF
	Global("Out_of_Spells","LOCALS",2)
	DifficultyGT(EASY)
        HaveSpell(WIZARD_DRAGONS_BREATH)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",0)
END

IF
	Global("Out_of_Spells","LOCALS",3)
	DifficultyGT(EASIEST)
        OR(5)
	        HaveSpell(WIZARD_MAZE)
		HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
		HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)
                HaveSpell(WIZARD_POWER_WORD_BLIND)
                !GlobalTimerNotExpired("Spell_Sequencer_Timer","LOCALS")
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",0)
END

IF
	Global("Out_of_Area_Spells","LOCALS",2)
	DifficultyGT(EASY)
        HaveSpell(WIZARD_DRAGONS_BREATH)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",0)
END

IF
	Global("Out_of_Area_Spells","LOCALS",3)
	DifficultyGT(EASIEST)
        HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",0)
END

IF
	OR(2)
             Global("Out_of_Spells","LOCALS",1)
	     Global("Out_of_Spells","LOCALS",3)
	Difficulty(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",2)
END

IF
	OR(2)
             Global("Out_of_Area_Spells","LOCALS",1)
	     Global("Out_of_Area_Spells","LOCALS",3)
	Difficulty(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",2)
END

IF
	OR(2)
             Global("Out_of_Spells","LOCALS",1)
	     Global("Out_of_Spells","LOCALS",2)
	Difficulty(EASIEST)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",3)
END

IF
	OR(2)
             Global("Out_of_Area_Spells","LOCALS",1)
	     Global("Out_of_Area_Spells","LOCALS",2)
	Difficulty(EASIEST)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Area_Spells","LOCALS",3)
END

IF
	Global("Out_of_Spells","LOCALS",1)
	DifficultyGT(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Spells","LOCALS",4)
END

IF
	Global("Out_of_Area_Spells","LOCALS",1)
	DifficultyGT(EASY)
THEN
	RESPONSE #100
		SetGlobal("Out_of_Ara_Spells","LOCALS",4)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_VOCALIZE)
	CheckStat(Myself,0,POLYMORPHED)
	StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,RZ_STATE_DISABLED)
	!StateCheck(Myself,STATE_BERSERK)
	See(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		Spell(Myself,WIZARD_VOCALIZE)
		SetInterrupt(TRUE)
END

IF
	OR(3)
		!Allegiance(Myself,ENEMY)
		StateCheck(Myself,RZ_STATE_DISABLED)
		StateCheck(Myself,STATE_BERSERK)
THEN
	RESPONSE #100
	         NoAction()
END

IF
	Global("RZ_See_Enemy","LOCALS",0)
	OR(19)
		See(NearestEnemyOf(Myself))
		AttackedBy([GOODCUTOFF.0.0.0.0.SUMMONED],DEFAULT)
		AttackedBy([PC],DEFAULT)
		AttackedBy([FAMILIAR],DEFAULT)
		AttackedBy([ALLY],DEFAULT)
		AttackedBy([CONTROLLED],DEFAULT)
		AttackedBy([CHARMED],DEFAULT)
		HitBy([GOODCUTOFF.0.0.0.0.SUMMONED],CRUSHING)
		HitBy([PC],CRUSHING)
		HitBy([FAMILIAR],CRUSHING)
		HitBy([ALLY],CRUSHING)
		HitBy([CONTROLLED],CRUSHING)
		HitBy([CHARMED],CRUSHING)
		SpellCastOnMe([GOODCUTOFF.0.0.0.0.SUMMONED],0)
		SpellCastOnMe([PC],0)
		SpellCastOnMe([FAMILIAR],0)
		SpellCastOnMe([ALLY],0)
		SpellCastOnMe([CONTROLLED],0)
		SpellCastOnMe([CHARMED],0)
THEN
	RESPONSE #100
		SetGlobal("RZ_See_Enemy","LOCALS",1)
		Shout(100)
END

IF
	!GlobalTimerNotExpired("RZ_Call_For_Help","LOCALS")
	HPPercentLT(Myself,70)
	Or(2)
		AttackedBy([GOODCUTOFF],DEFAULT)
		HitBy([GOODCUTOFF],CRUSHING)
	See(LastAttackerOf(Myself))
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		SetGlobalTimer("RZ_Call_For_Help","LOCALS",18)
		Shout(101)
END

IF
        Global("RZ_Move_To_PC","LOCALS",1)
	Or(2)
             !CheckStat(Player1,0,SANCTUARY)
	     StateCheck(Player1,STATE_INVISIBLE)
        Or(3)
             !CheckStat(Player2,0,SANCTUARY)
	     StateCheck(Player2,STATE_INVISIBLE)
	     HPLT(Player2,1)
        Or(3)
             !CheckStat(Player3,0,SANCTUARY)
	     StateCheck(Player3,STATE_INVISIBLE)
	     HPLT(Player3,1)
        Or(3)
             !CheckStat(Player4,0,SANCTUARY)
	     StateCheck(Player4,STATE_INVISIBLE)
	     HPLT(Player4,1)
        Or(3)
             !CheckStat(Player5,0,SANCTUARY)
	     StateCheck(Player5,STATE_INVISIBLE)
	     HPLT(Player5,1)
        Or(3)
             !CheckStat(Player6,0,SANCTUARY)
	     StateCheck(Player6,STATE_INVISIBLE)
	     HPLT(Player6,1)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",0)
	OR(2)
		Heard([ENEMY],100)
		Heard([ENEMY],101)
	!Range(LastHeardBy(Myself),0)
	!Detect(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		SetGlobalTimer("RZ_Chase_Timer","LOCALS",30)
		MoveToObject(LastHeardBy(Myself))
END

IF
	Global("RZ_Move_To_PC","LOCALS",1)
	OR(3)
	     ActionListEmpty()
             !GlobalTimerNotExpired("RZ_Chase_Timer","LOCALS")
	     Detect(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",0)
		ClearActions(Myself)
END

IF
	Global("RZ_See_Enemy","LOCALS",0)
	Global("RZ_Move_To_PC","LOCALS",0)
THEN
	RESPONSE #100
	         RandomWalk()
END

IF
  Global("Out_of_Area_Spells","LOCALS",0)
  !HasItem("RZSEEINV",Myself)
  OR(2)
       !GlobalTimerNotExpired("Action_Timer","LOCALS")
       ActionListEmpty()
THEN
    RESPONSE #100
             CreateItem("RZSEEINV",0,0,0)
             FillSlot(SLOT_BOOTS)
             Continue()
END

IF
  Global("Out_of_Area_Spells","LOCALS",0)
  Global("No_Target_Available","LOCALS",0)
  HasItem("RZSEEINV",Myself)
  See([GOODCUTOFF])
  StateCheck([GOODCUTOFF],STATE_INVISIBLE)
       CheckStat([GOODCUTOFF],0,SANCTUARY)
       CheckStat([GOODCUTOFF],0,SHIELDGLOBE)
       CheckStat([GOODCUTOFF],0,MINORGLOBE)
  See(SecondNearest([GOODCUTOFF]))
  StateCheck(SecondNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(SecondNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(SecondNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(SecondNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(ThirdNearest([GOODCUTOFF]))
  StateCheck(ThirdNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(ThirdNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(ThirdNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(ThirdNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(FourthNearest([GOODCUTOFF]))
  StateCheck(FourthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(FourthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(FourthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(FourthNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(FifthNearest([GOODCUTOFF]))
  StateCheck(FifthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(FifthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(FifthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(FifthNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(SixthNearest([GOODCUTOFF]))
  StateCheck(SixthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(SixthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(SixthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(SixthNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(SeventhNearest([GOODCUTOFF]))
  StateCheck(SeventhNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(SeventhNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(SeventhNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(SeventhNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(EighthNearest([GOODCUTOFF]))
  StateCheck(EighthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(EighthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(EighthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(EighthNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(NinthNearest([GOODCUTOFF]))
  StateCheck(NinthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(NinthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(NinthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(NinthNearest([GOODCUTOFF]),0,MINORGLOBE)
  See(TenthNearest([GOODCUTOFF]))
  StateCheck(TenthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       CheckStat(TenthNearest([GOODCUTOFF]),0,SANCTUARY)
       CheckStat(TenthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       CheckStat(TenthNearest([GOODCUTOFF]),0,MINORGLOBE)
THEN
    RESPONSE #100
           SetGlobal("No_Target_Available","LOCALS",1)
END

IF
  Global("No_Target_Available","LOCALS",1)
  See([GOODCUTOFF])
  OR(40)
       !StateCheck([GOODCUTOFF],STATE_INVISIBLE)
       !CheckStat([GOODCUTOFF],0,SANCTUARY)
       !CheckStat([GOODCUTOFF],0,SHIELDGLOBE)
       !CheckStat([GOODCUTOFF],0,MINORGLOBE)
       !StateCheck(SecondNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(SecondNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(SecondNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(SecondNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(ThirdNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(ThirdNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(ThirdNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(ThirdNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(FourthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(FourthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(FourthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(FourthNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(FifthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(FifthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(FifthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(FifthNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(SixthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(SixthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(SixthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(SixthNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(SeventhNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(SeventhNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(SeventhNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(SeventhNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(EighthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(EighthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(EighthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(EighthNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(NinthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(NinthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(NinthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(NinthNearest([GOODCUTOFF]),0,MINORGLOBE)
       !StateCheck(TenthNearest([GOODCUTOFF]),STATE_INVISIBLE)
       !CheckStat(TenthNearest([GOODCUTOFF]),0,SANCTUARY)
       !CheckStat(TenthNearest([GOODCUTOFF]),0,SHIELDGLOBE)
       !CheckStat(TenthNearest([GOODCUTOFF]),0,MINORGLOBE)
THEN
    RESPONSE #100
           SetGlobal("No_Target_Available","LOCALS",0)
END

IF
	Global("RZ_Move_To_PC","LOCALS",1)
THEN
	RESPONSE #100
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player1,1)
	CheckStat(Player1,0,SANCTUARY)
	!StateCheck(Player1,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player1)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player2,1)
	CheckStat(Player2,0,SANCTUARY)
	!StateCheck(Player2,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player2)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player3,1)
	CheckStat(Player3,0,SANCTUARY)
	!StateCheck(Player3,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player3)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player4,1)
	CheckStat(Player4,0,SANCTUARY)
	!StateCheck(Player4,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player4)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player5,1)
	CheckStat(Player5,0,SANCTUARY)
	!StateCheck(Player5,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player5)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	Global("RZ_See_Enemy","LOCALS",1)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	!HPLT(Player6,1)
	CheckStat(Player6,0,SANCTUARY)
	!StateCheck(Player6,STATE_INVISIBLE)
THEN
	RESPONSE #100
		SetGlobal("RZ_Move_To_PC","LOCALS",1)
		MoveToObject(Player6)
END

IF
	Global("RZ_Move_To_PC","LOCALS",0)
	!Global("RZ_See_Enemy","LOCALS",0)
	OR(2)
	     !See(NearestEnemyOf(Myself))
	     Global("No_Target_Available","LOCALS",1)
	OR(2)
	     GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
             !HaveSpell(WIZARD_TRUE_SIGHT)
        OR(2)
	     GlobalTimerNotExpired("True_Sight_Timer","LOCALS")
	     !HaveSpell(WIZARD_ORACLE)
THEN
	RESPONSE #100
		RandomWalkContinuous()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
        OR(2)
	     GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
             !HaveSpell(WIZARD_TIME_STOP)
	HaveSpell(WIZARD_SUMMON_PLANATAR_EVIL)
	DifficultyGT(EASY)
        See(NearestEnemyOf(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_SUMMON_PLANATAR_EVIL)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Spell_Trigger_Timer","LOCALS")
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	DifficultyGT(EASY)
	OR(2)
	     !StateCheck(Myself,STATE_INVISIBLE)
	     Global("See_Invisible","LOCALS",1)
	OR(2)
	     !HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
	     HPPercentLT(Myself,70)
        OR(2)
	     !HaveSpell(WIZARD_STONE_SKIN)
	     HPPercentLT(Myself,70)
	OR(2)
		AttackedBy([GOODCUTOFF],0)
		!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Spell_Trigger_Timer","LOCALS",4800)
		SetGlobalTimer("PfMW_Timer","LOCALS",24)
		DisplayString(Myself,26243) // Kouzeln· spouöù
		EquipMostDamagingMelee()
		SmallWait(1)
		ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		ReallyForceSpell(Myself,WIZARD_CHAOS)
		ReallyForceSpell(Myself,WIZARD_STONE_SKIN)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	!GlobalTimerNotExpired("PfMW_Timer","LOCALS")
	OR(2)
	     !StateCheck(Myself,STATE_INVISIBLE)
	     Global("See_Invisible","LOCALS",1)
	OR(2)
		AttackedBy([GOODCUTOFF],0)
		!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Minor_Sequencer_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	OR(2)
	    GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	    !GlobalTimerNotExpired("PC_True_Sight","MYAREA")
        OR(2)
	     !HaveSpell(WIZARD_MIRROR_IMAGE)
	     HPPercentLT(Myself,70)
	OR(4)
		GlobalTimerNotExpired("Spell_Trigger_Timer","LOCALS")
		DifficultyLT(NORMAL)
		Global("Elemental_Attack","LOCALS",1)
		!Global("Out_of_Spells","LOCALS",0)
	OR(4)
		GlobalTimerNotExpired("Spell_Sequencer_Timer","LOCALS")
		DifficultyLT(EASY)
		Global("Elemental_Attack","LOCALS",1)
		!Global("Out_of_Spells","LOCALS",0)
	OR(3)
	     !StateCheck(Myself,STATE_INVISIBLE)
	     Global("See_Invisible","LOCALS",1)
	     Global("Elemental_Attack","LOCALS",1)
	OR(3)
		AttackedBy([GOODCUTOFF],0)
		!StateCheck(Myself,STATE_INVISIBLE)
		Global("Elemental_Attack","LOCALS",1)
	OR(3)
		CheckStatLT(Myself,3,STONESKINS)
		Global("Elemental_Attack","LOCALS",1)
		!Global("Out_of_Spells","LOCALS",0)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Minor_Sequencer_Timer","LOCALS",4800)
		DisplayString(Myself,5013) // SlaböÌ po¯adaË kouzel
		SmallWait(1)
		SetGlobalTimer("Mirror_Image_Timer","LOCALS",138)
		SetGlobal("Mirror_Image","LOCALS",1)
		EquipMostDamagingMelee()
		ReallyForceSpell(Myself,WIZARD_MIRROR_IMAGE)
		ReallyForceSpell(Myself,WIZARD_BLUR)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_STONE_SKIN)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,2,STONESKINS)
	OR(2)
	     !StateCheck(Myself,STATE_INVISIBLE)
	     Global("See_Invisible","LOCALS",1)
	OR(2)
		AttackedBy([GOODCUTOFF],0)
		!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_STONE_SKIN)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	GlobalLT("Staff_of_Power_Globe","LOCALS",10)
        DifficultyGT(EASY)
        CheckStat(Myself,0,MINORGLOBE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		IncrementGlobal("Staff_of_Power_Globe","LOCALS",1)
		EquipMostDamagingMelee()
		ForceSpellRES("va#staf2",Myself)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_MIRROR_IMAGE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	OR(2)
	    GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	    !GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	OR(3)
	     !StateCheck(Myself,STATE_INVISIBLE)
	     Global("See_Invisible","LOCALS",1)
	     Global("Elemental_Attack","LOCALS",1)
	OR(3)
		AttackedBy([GOODCUTOFF],0)
		!StateCheck(Myself,STATE_INVISIBLE)
		Global("Elemental_Attack","LOCALS",1)
	OR(3)
		CheckStatLT(Myself,3,STONESKINS)
		Global("Elemental_Attack","LOCALS",1)
		!Global("Out_of_Spells","LOCALS",0)
	OR(4)
		GlobalTimerNotExpired("Spell_Trigger_Timer","LOCALS")
		DifficultyLT(NORMAL)
		Global("Elemental_Attack","LOCALS",1)
		!Global("Out_of_Spells","LOCALS",0)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobal("Mirror_Image","LOCALS",0)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_MIRROR_IMAGE)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_MISLEAD)
	CheckStat(Myself,0,POLYMORPHED)
	OR(2)
	    GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	    !GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	OR(2)
	    !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	    !GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobal("Change_AI","LOCALS",0)
		SetGlobal("Invisibility","LOCALS",0)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_MISLEAD)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SHADOW_DOOR)
	CheckStat(Myself,0,POLYMORPHED)
	OR(2)
	    GlobalTimerNotExpired("Spell_Immunity_Divination","LOCALS")
	    !GlobalTimerNotExpired("PC_True_Sight","MYAREA")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobal("Invisibility","LOCALS",0)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_SHADOW_DOOR)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HasItem("potn55",Myself)
	HPPercentLT(Myself,60)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		UseItem("potn55",Myself)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TIME_STOP)
	DifficultyGT(EASY)
	CheckStat(Myself,0,POLYMORPHED)
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	OR(4)
		Global("Time_Stop","LOCALS",0)
		!GlobalTimerNotExpired("Time_Stop_Delay_Timer","LOCALS")
		GlobalTimerNotExpired("Spell_Trigger_Timer","LOCALS")
		HPPercentLT(Myself,50)
	OR(5)
		Global("Time_Stop","LOCALS",0)
		!GlobalTimerNotExpired("Time_Stop_Delay_Timer","LOCALS")
		!HaveSpell(WIZARD_MISLEAD)
		!HaveSpell(WIZARD_SHADOW_DOOR)
		HPPercentLT(Myself,50)
	OR(6)
                Global("Time_Stop","LOCALS",0)
                !GlobalTimerNotExpired("Time_Stop_Delay_Timer","LOCALS")
		StateCheck(Myself,STATE_MIRRORIMAGE)
		!HaveSpell(WIZARD_STONE_SKIN)
		CheckStatGT(Myself,3,STONESKINS)
		StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Time_Stop_Delay_Timer","LOCALS",36)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_TIME_STOP) 
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	Global("Spell_Immunity","LOCALS",0)
	HaveSpell(WIZARD_SPELL_IMMUNITY)
	OR(2)
	     GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
             !HaveSpell(WIZARD_TIME_STOP)
        Or(3)
	    HaveSpell(WIZARD_SHADOW_DOOR)
	    HaveSpell(WIZARD_MISLEAD)
            StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
	        SetGlobal("Spell_Immunity","LOCALS",1)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		SpellNoDec(Myself,WIZARD_SPELL_IMMUNITY_DIVINATION)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPELL_TURNING)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
        !GlobalTimerNotExpired("Spell_Protection_Timer","LOCALS")
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_SPELL_TURNING)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SHIELD)
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	!GlobalTimerNotExpired("Spell_Protection_Timer","LOCALS")
	!HaveSpell(WIZARD_SPELL_TURNING)
	CheckStat(Myself,0,MINORGLOBE)
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	Global("No_Target_Available","LOCALS",0)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_SHIELD)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_PROTECTION_FROM_EVIL)
	Detect([0.0.0.0.0.SUMMONED_DEMON])
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(Myself,WIZARD_PROTECTION_FROM_EVIL)
		SetInterrupt(TRUE)
END

IF
       Global("No_Target_Available","LOCALS",1)
THEN
    RESPONSE #100
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_DEATH_SPELL)
	CheckStat(Myself,0,POLYMORPHED)
	OR(2)
		!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!See([PC])
	See([GOODCUTOFF.0.0.0.0.SUMMONED])
	OR(2)
		!CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
		!HaveSpell(WIZARD_SKULL_TRAP)
	OR(2)
		!CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
		!HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	OR(2)
		!CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
		!HaveSpell(WIZARD_MAGIC_MISSILE)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobal("RZ_RERUN","LOCALS",0)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_DEATH_SPELL)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SKULL_TRAP)
	CheckStat(Myself,0,POLYMORPHED)
	NumCreatureLT([ENEMY],3)
	!GlobalTimerNotExpired("Death_Spell","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!See([PC])
	See([GOODCUTOFF.0.0.0.0.SUMMONED])
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		NumCreatureGT([GOODCUTOFF],1)
	OR(2)
		StateCheck(Myself,STATE_MIRRORIMAGE)
		!Range(LastSeenBy(Myself),12)
	CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_SKULL_TRAP)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MAGIC_MISSILE)
	CheckStat(Myself,0,POLYMORPHED)
	!GlobalTimerNotExpired("Death_Spell","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!See([PC])
	See([GOODCUTOFF.0.0.0.0.SUMMONED])
	CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_MAGIC_MISSILE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	!GlobalTimerNotExpired("Death_Spell","LOCALS")
	OR(2)
		!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!See([PC])
	Detect([GOODCUTOFF.0.0.0.0.SUMMONED])
	CheckStatGT(LastSeenBy(Myself),70,RESISTSLASHING)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_IMPROVED_HASTE)
	CheckStat(Myself,0,POLYMORPHED)
	OR(4)
	    See([ENEMY.0.0.0.0.SUMMONED])
            See([ENEMY.WEAPON.SWORD])
            See(Myself)
            See([ENEMY.0.DARKPLANATAR])
        !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_HASTE)
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	OR(2)
		NumCreatureGT([ENEMY.0.0.0.0.SUMMONED],2)
		!HaveSpell(WIZARD_MORDENKAINENS_SWORD)
	Detect([ENEMY.0.0.0.0.SUMMONED])
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_HASTE)
		SetInterrupt(TRUE)
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_DISPEL_MAGIC)
	OR(2)
	     RandomNumGT(10,8)
	     !GlobalTimerNotExpired("Greater_Malison_Timer","LOCALS")
	!GlobalTimerNotExpired("Dispel_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(NearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	See(NearestEnemyOf(Myself))
	OR(6)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See([PC])
		!HasImmunityEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
	        !See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC])
		!HasImmunityEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See([PC])
		!HasBounceEffects([PC])
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!HasImmunityEffects([PC])
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!HasImmunityEffects(SecondNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!HasImmunityEffects(ThirdNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!HasImmunityEffects(FourthNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!HasImmunityEffects(FifthNearest([PC]))
		CheckStat(Nearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!HasImmunityEffects(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		!StateCheck([PC],RZ_STATE_DISPEL)
		CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_DISPEL)
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_DISPEL_MAGIC)
	OR(2)
	     RandomNumGT(10,8)
	     !GlobalTimerNotExpired("Greater_Malison_Timer","LOCALS")
	!GlobalTimerNotExpired("Dispel_Timer","LOCALS")
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!StateCheck(NearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	!Allegiance(LastSeenBy(Myself),ENEMY)
	OR(4)
		StateCheck(LastSeenBy(Myself),RZ_STATE_DISPEL)
		!CheckStat(LastSeenBy(Myself),0,STONESKINS)
		HasBounceEffects(LastSeenBy(Myself))
		HasImmunityEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Dispel_Timer","LOCALS",60)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_DISPEL_MAGIC)
		SetInterrupt(TRUE)
	RESPONSE #100
		SetGlobalTimer("Dispel_Timer","LOCALS",6)
		Continue()
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	 !GlobalTimerNotExpired("Silence_Timer","LOCALS")
	 !GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
        OR(2)
	     HaveSpell(WIZARD_POWER_WORD_SILENCE)
	     HasItem("wand19",Myself)
        OR(2)
	     HasItem("wand19",Myself)
	     CheckStat(Myself,0,POLYMORPHED)
	OR(2)
	     HasItem("wand19",Myself)
	     !StateCheck(Myself,STATE_SILENCED)
        OR(2)
	     HasItem("wand19",Myself)
	     CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		!See([PC.0.0.PALADIN_ALL])
		!Kit([PC.0.0.PALADIN_ALL],INQUISITOR)
		StateCheck([PC.0.0.PALADIN_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.PALADIN_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.PALADIN_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.PALADIN_ALL],RZ_STATE_DISABLED)
		HasImmunityEffects([PC.0.0.PALADIN_ALL])
		HasBounceEffects([PC.0.0.PALADIN_ALL])
	OR(8)
		!See(SecondNearest([PC.0.0.PALADIN_ALL]))
		!Kit(SecondNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SecondNearest([PC.0.0.PALADIN_ALL]))
		HasBounceEffects(SecondNearest([PC.0.0.PALADIN_ALL]))
	OR(8)
		!See(ThirdNearest([PC.0.0.PALADIN_ALL]))
		!Kit(ThirdNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(ThirdNearest([PC.0.0.PALADIN_ALL]))
		HasBounceEffects(ThirdNearest([PC.0.0.PALADIN_ALL]))
	OR(8)
		!See(FourthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(FourthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FourthNearest([PC.0.0.PALADIN_ALL]))
		HasBounceEffects(FourthNearest([PC.0.0.PALADIN_ALL]))
	OR(8)
		!See(FifthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(FifthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FifthNearest([PC.0.0.PALADIN_ALL]))
		HasBounceEffects(FifthNearest([PC.0.0.PALADIN_ALL]))
	OR(8)
		!See(SixthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(SixthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SixthNearest([PC.0.0.PALADIN_ALL]))
		HasBounceEffects(SixthNearest([PC.0.0.PALADIN_ALL]))
	OR(7)
		!See([PC.0.0.MAGE_ALL])
		StateCheck([PC.0.0.MAGE_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.MAGE_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.MAGE_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.MAGE_ALL],RZ_STATE_DISABLED)
		HasImmunityEffects([PC.0.0.MAGE_ALL])
		HasBounceEffects([PC.0.0.MAGE_ALL])
	OR(7)
		!See(SecondNearest([PC.0.0.MAGE_ALL]))
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SecondNearest([PC.0.0.MAGE_ALL]))
		HasBounceEffects(SecondNearest([PC.0.0.MAGE_ALL]))
	OR(7)
		!See(ThirdNearest([PC.0.0.MAGE_ALL]))
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(ThirdNearest([PC.0.0.MAGE_ALL]))
		HasBounceEffects(ThirdNearest([PC.0.0.MAGE_ALL]))
	OR(7)
		!See(FourthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FourthNearest([PC.0.0.MAGE_ALL]))
		HasBounceEffects(FourthNearest([PC.0.0.MAGE_ALL]))
	OR(7)
		!See(FifthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FifthNearest([PC.0.0.MAGE_ALL]))
		HasBounceEffects(FifthNearest([PC.0.0.MAGE_ALL]))
	OR(7)
		!See(SixthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SixthNearest([PC.0.0.MAGE_ALL]))
		HasBounceEffects(SixthNearest([PC.0.0.MAGE_ALL]))
	OR(7)
		!See([PC.0.0.BARD_ALL])
		StateCheck([PC.0.0.BARD_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.BARD_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.BARD_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.BARD_ALL],RZ_STATE_DISABLED)
		HasImmunityEffects([PC.0.0.BARD_ALL])
		HasBounceEffects([PC.0.0.BARD_ALL])
	OR(7)
		!See(SecondNearest([PC.0.0.BARD_ALL]))
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SecondNearest([PC.0.0.BARD_ALL]))
		HasBounceEffects(SecondNearest([PC.0.0.BARD_ALL]))
	OR(7)
		!See(ThirdNearest([PC.0.0.BARD_ALL]))
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(ThirdNearest([PC.0.0.BARD_ALL]))
		HasBounceEffects(ThirdNearest([PC.0.0.BARD_ALL]))
	OR(7)
		!See(FourthNearest([PC.0.0.BARD_ALL]))
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FourthNearest([PC.0.0.BARD_ALL]))
		HasBounceEffects(FourthNearest([PC.0.0.BARD_ALL]))
	OR(7)
		!See(FifthNearest([PC.0.0.BARD_ALL]))
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FifthNearest([PC.0.0.BARD_ALL]))
		HasBounceEffects(FifthNearest([PC.0.0.BARD_ALL]))
	OR(7)
		!See(SixthNearest([PC.0.0.BARD_ALL]))
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SixthNearest([PC.0.0.BARD_ALL]))
		HasBounceEffects(SixthNearest([PC.0.0.BARD_ALL]))
	OR(7)
		!See([PC.0.0.CLERIC_ALL])
		StateCheck([PC.0.0.CLERIC_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.CLERIC_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.CLERIC_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.CLERIC_ALL],RZ_STATE_DISABLED)
		HasImmunityEffects([PC.0.0.CLERIC_ALL])
		HasBounceEffects([PC.0.0.CLERIC_ALL])
	OR(7)
		!See(SecondNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SecondNearest([PC.0.0.CLERIC_ALL]))
		HasBounceEffects(SecondNearest([PC.0.0.CLERIC_ALL]))
	OR(7)
		!See(ThirdNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(ThirdNearest([PC.0.0.CLERIC_ALL]))
		HasBounceEffects(ThirdNearest([PC.0.0.CLERIC_ALL]))
	OR(7)
		!See(FourthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FourthNearest([PC.0.0.CLERIC_ALL]))
		HasBounceEffects(FourthNearest([PC.0.0.CLERIC_ALL]))
	OR(7)
		!See(FifthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FifthNearest([PC.0.0.CLERIC_ALL]))
		HasBounceEffects(FifthNearest([PC.0.0.CLERIC_ALL]))
	OR(7)
		!See(SixthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SixthNearest([PC.0.0.CLERIC_ALL]))
		HasBounceEffects(SixthNearest([PC.0.0.CLERIC_ALL]))
	OR(7)
		!See([PC.0.0.DRUID_ALL])
		StateCheck([PC.0.0.DRUID_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.DRUID_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.DRUID_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.DRUID_ALL],RZ_STATE_DISABLED)
		HasImmunityEffects([PC.0.0.DRUID_ALL])
		HasBounceEffects([PC.0.0.DRUID_ALL])
	OR(7)
		!See(SecondNearest([PC.0.0.DRUID_ALL]))
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SecondNearest([PC.0.0.DRUID_ALL]))
		HasBounceEffects(SecondNearest([PC.0.0.DRUID_ALL]))
	OR(7)
		!See(ThirdNearest([PC.0.0.DRUID_ALL]))
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(ThirdNearest([PC.0.0.DRUID_ALL]))
		HasBounceEffects(ThirdNearest([PC.0.0.DRUID_ALL]))
	OR(7)
		!See(FourthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FourthNearest([PC.0.0.DRUID_ALL]))
		HasBounceEffects(FourthNearest([PC.0.0.DRUID_ALL]))
	OR(7)
		!See(FifthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(FifthNearest([PC.0.0.DRUID_ALL]))
		HasBounceEffects(FifthNearest([PC.0.0.DRUID_ALL]))
	OR(7)
		!See(SixthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
		HasImmunityEffects(SixthNearest([PC.0.0.DRUID_ALL]))
		HasBounceEffects(SixthNearest([PC.0.0.DRUID_ALL]))
	OR(6)
		!See([PC.0.0.PALADIN_ALL])
		!Kit([PC.0.0.PALADIN_ALL],INQUISITOR)
		StateCheck([PC.0.0.PALADIN_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.PALADIN_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.PALADIN_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.PALADIN_ALL],RZ_STATE_DISABLED)
	OR(6)
		!See(SecondNearest([PC.0.0.PALADIN_ALL]))
		!Kit(SecondNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
	OR(6)
		!See(ThirdNearest([PC.0.0.PALADIN_ALL]))
		!Kit(ThirdNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
	OR(6)
		!See(FourthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(FourthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
	OR(6)
		!See(FifthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(FifthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
	OR(6)
		!See(SixthNearest([PC.0.0.PALADIN_ALL]))
		!Kit(SixthNearest([PC.0.0.PALADIN_ALL]),INQUISITOR)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.PALADIN_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.PALADIN_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC.0.0.MAGE_ALL])
		StateCheck([PC.0.0.MAGE_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.MAGE_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.MAGE_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.MAGE_ALL],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC.0.0.MAGE_ALL]))
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC.0.0.MAGE_ALL]))
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC.0.0.MAGE_ALL]))
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.MAGE_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC.0.0.BARD_ALL])
		StateCheck([PC.0.0.BARD_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.BARD_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.BARD_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.BARD_ALL],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC.0.0.BARD_ALL]))
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
	OR(5)
	        !See(ThirdNearest([PC.0.0.BARD_ALL]))
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC.0.0.BARD_ALL]))
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC.0.0.BARD_ALL]))
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC.0.0.BARD_ALL]))
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.BARD_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.BARD_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC.0.0.CLERIC_ALL])
		StateCheck([PC.0.0.CLERIC_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.CLERIC_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.CLERIC_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.CLERIC_ALL],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC.0.0.CLERIC_ALL]))
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.CLERIC_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.CLERIC_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See([PC.0.0.DRUID_ALL])
		StateCheck([PC.0.0.DRUID_ALL],STATE_INVISIBLE)
		StateCheck([PC.0.0.DRUID_ALL],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC.0.0.DRUID_ALL],0,SANCTUARY)
		StateCheck([PC.0.0.DRUID_ALL],RZ_STATE_DISABLED)
	OR(5)
		!See(SecondNearest([PC.0.0.DRUID_ALL]))
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(SecondNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(ThirdNearest([PC.0.0.DRUID_ALL]))
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FourthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(FourthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(FifthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(FifthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
	OR(5)
		!See(SixthNearest([PC.0.0.DRUID_ALL]))
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC.0.0.DRUID_ALL]),0,SANCTUARY)
		StateCheck(SixthNearest([PC.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Silence_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_SILENCE)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
		Kit(LastSeenBy(Myself),INQUISITOR)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),BARD_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!StateCheck(LastSeenBy(Myself),STATE_SILENCED)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Silence_Timer","LOCALS",30)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_SILENCE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	OR(2)
	!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("Silence_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HasItem("wand19",Myself)
	See(LastSeenBy(Myself))
	OR(5)
		Kit(LastSeenBy(Myself),INQUISITOR)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),BARD_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!StateCheck(LastSeenBy(Myself),STATE_SILENCED)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Silence_Timer","LOCALS",30)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		UseItem("wand19",LastSeenBy(Myself))
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
		Global("Out_of_Spells","LOCALS",0)
        Or(3)
	     GlobalLT("Staff_of_Power","LOCALS",20)
             HasItem("wand04",Myself)
	     CheckStat(Myself,0,POLYMORPHED)
	Or(3)
	     GlobalLT("Staff_of_Power","LOCALS",20)
             HasItem("wand04",Myself)
	     !StateCheck(Myself,STATE_SILENCED)
	OR(3)
	     GlobalLT("Staff_of_Power","LOCALS",20)
             HasItem("wand04",Myself)
	     CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	See(NearestEnemyOf(Myself))
	OR(8)
		RandomNumGT(8,1)
		!See(LastAttackerOf(Myself))
		StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
		StateCheck(LastAttackerOf(Myself),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
		StateCheck(LastAttackerOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(LastAttackerOf(Myself))
		HasImmunityEffects(LastAttackerOf(Myself))
	OR(8)
		RandomNumGT(3,1)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(MostDamagedOf([PC]))
		HasImmunityEffects(MostDamagedOf([PC]))
	OR(8)
		RandomNumGT(100,25)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(ThirdNearest([PC]))
		HasImmunityEffects(ThirdNearest([PC]))
	OR(8)
		RandomNumGT(100,46)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(SixthNearest([PC]))
		HasImmunityEffects(SixthNearest([PC]))
	OR(8)
		RandomNumGT(100,63)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(SecondNearest([PC]))
		HasImmunityEffects(SecondNearest([PC]))
	OR(8)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(FourthNearest([PC]))
		HasImmunityEffects(FourthNearest([PC]))
	OR(8)
		RandomNumGT(100,85)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
		HasBounceEffects([PC])
		HasImmunityEffects([PC])
	OR(8)
		RandomNumGT(100,90)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		HasBounceEffects(FifthNearest([PC]))
		HasImmunityEffects(FifthNearest([PC]))
	OR(7)
		RandomNumGT(12,4)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		HasBounceEffects(MostDamagedOf([PC]))
		HasImmunityEffects(MostDamagedOf([PC]))
        OR(7)
		RandomNumGT(200,50)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		HasBounceEffects(ThirdNearest([PC]))
		HasImmunityEffects(ThirdNearest([PC]))
	OR(7)
		RandomNumGT(200,92)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(SixthNearest([PC]))
		HasImmunityEffects(SixthNearest([PC]))
	OR(7)
		RandomNumGT(200,189)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		HasBounceEffects(SecondNearest([PC]))
		HasImmunityEffects(SecondNearest([PC]))
	OR(7)
		RandomNumGT(200,152)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(FourthNearest([PC]))
		HasImmunityEffects(FourthNearest([PC]))
	OR(7)
		RandomNumGT(200,170)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		HasBounceEffects([PC])
		HasImmunityEffects([PC])
	OR(7)
		RandomNumGT(200,180)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		HasBounceEffects(FifthNearest([PC]))
		HasImmunityEffects(FifthNearest([PC]))
	OR(6)
		RandomNumGT(21,7)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,75)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,138)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,189)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,228)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,255)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(6)
		RandomNumGT(300,270)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(5)
		RandomNumGT(30,10)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(400,100)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(400,184)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(400,252)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(400,304)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(5)
		RandomNumGT(400,340)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(5)
		RandomNumGT(400,360)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(4)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
        OR(4)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		!CheckStat([PC],0,SANCTUARY)
	OR(4)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
        Global("Out_of_Area_Spells","LOCALS",0)
	OR(4)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(4)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(4)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See([PC])
                CheckStat([PC],0,SANCTUARY)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SHIELDGLOBE)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See([PC])
                CheckStat([PC],0,SHIELDGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		!HasBounceEffects(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See([PC])
                !HasBounceEffects([PC])
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See([PC])
                CheckStat([PC],0,MINORGLOBE)
		StateCheck([PC],RZ_STATE_DISABLED)
	OR(3)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
	OR(3)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
		!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See([PC])
		StateCheck([PC],STATE_INVISIBLE)
		!StateCheck([PC],STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SecondNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
		!StateCheck(ThirdNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FourthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(FifthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(3)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
		!StateCheck(SixthNearest([PC]),STATE_IMPROVEDINVISIBILITY)
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
	OR(2)
		!See([PC])
                CheckStat([PC],0,SANCTUARY)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SANCTUARY)
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,SHIELDGLOBE)
	OR(2)
		!See([PC])
                CheckStat([PC],0,SHIELDGLOBE)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,SHIELDGLOBE)
	OR(2)
		!See(MostDamagedOf([PC]))
		!HasBounceEffects(MostDamagedOf([PC]))
	OR(2)
		!See([PC])
                !HasBounceEffects([PC])
	OR(2)
		!See(SecondNearest([PC]))
		!HasBounceEffects(SecondNearest([PC]))
	OR(2)
		!See(ThirdNearest([PC]))
		!HasBounceEffects(ThirdNearest([PC]))
	OR(2)
		!See(FourthNearest([PC]))
		!HasBounceEffects(FourthNearest([PC]))
	OR(2)
		!See(FifthNearest([PC]))
		!HasBounceEffects(FifthNearest([PC]))
	OR(2)
		!See(SixthNearest([PC]))
		!HasBounceEffects(SixthNearest([PC]))
	OR(2)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
	OR(2)
		!See([PC])
                CheckStat([PC],0,MINORGLOBE)
	OR(2)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,MINORGLOBE)
	OR(2)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,MINORGLOBE)
	OR(6)
		!See(NearestEnemyOf(Myself))
		StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(NearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(NearestEnemyOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(NearestEnemyOf(Myself))
		HasImmunityEffects(NearestEnemyOf(Myself))
	OR(6)
		!See(SecondNearestEnemyOf(Myself))
		StateCheck(SecondNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(SecondNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(SecondNearestEnemyOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(SecondNearestEnemyOf(Myself))
		HasImmunityEffects(SecondNearestEnemyOf(Myself))
	OR(6)
		!See(ThirdNearestEnemyOf(Myself))
		StateCheck(ThirdNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(ThirdNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(ThirdNearestEnemyOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(ThirdNearestEnemyOf(Myself))
		HasImmunityEffects(ThirdNearestEnemyOf(Myself))
	OR(6)
		!See(FourthNearestEnemyOf(Myself))
		StateCheck(FourthNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(FourthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FourthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(FourthNearestEnemyOf(Myself))
		HasImmunityEffects(FourthNearestEnemyOf(Myself))
	OR(6)
		!See(FifthNearestEnemyOf(Myself))
		StateCheck(FifthNearestEnemyOf(Myself),STATE_INVISIBLE)
		!CheckStat(FifthNearestEnemyOf(Myself),0,SANCTUARY)
		StateCheck(FifthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
		HasBounceEffects(FifthNearestEnemyOf(Myself))
		HasImmunityEffects(FifthNearestEnemyOf(Myself))
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_TELEPORT_FIELD)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
	     NumCreatureGT([GOODCUTOFF],1)
	     CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		SpellPoint([556.534],WIZARD_TELEPORT_FIELD)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SPHERE_OF_CHAOS)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		SpellPoint([556.534],WIZARD_SPHERE_OF_CHAOS)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		NumCreatureGT([GOODCUTOFF],1)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHAOS)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_CHAOS)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_DRAGONS_BREATH)
	DifficultyGT(EASY)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		NumCreatureGT([GOODCUTOFF],1)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_DRAGONS_BREATH)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_CONFUSION)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
		NumCreatureGT([GOODCUTOFF],1)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_CONFUSION)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_SLOW)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	StateCheck(LastSeenBy(Myself),STATE_HASTED)
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_SLOW)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_BLIND)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!Range(LastSeenBy(Myself),15)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_BLIND)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	HPPercentLT(LastSeenBy(Myself),60)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SUN_FIRE)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	Range(LastSeenBy(Myself),12)
	!Range([ENEMY],15)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		Spell(Myself,WIZARD_SUN_FIRE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	OR(2)
	     !CheckStatLT(Myself,34,SPELLFAILUREMAGE)
             !GlobalTimerNotExpired("Use_Item_Timer","LOCALS")
        GlobalLT("Staff_of_Power_Stun","LOCALS",10)
        DifficultyGT(EASY)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Use_Item_Timer","LOCALS",30)
		IncrementGlobal("Staff_of_Power_Stun","LOCALS",1)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		ForceSpellRES("VA#STAF1",LastSeenBy(Myself))
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	OR(2)
	!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!GlobalTimerNotExpired("Use_Item_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HasItem("wand04",Myself)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Use_Item_Timer","LOCALS",30)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		UseItem("wand04",LastSeenBy(Myself))
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
		NumCreatureGT([GOODCUTOFF],1)
		CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_GLITTERDUST)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_FINGER_OF_DEATH)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE2)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_MAZE)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),10)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_MAZE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_PRISMATIC_SPRAY)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		Spell(LastSeenBy(Myself),WIZARD_PRISMATIC_SPRAY)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_SUMMON_HAKEASHAR)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(4)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),BARD_ALL)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_SUMMON_HAKEASHAR)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_MORDENKAINENS_SWORD)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		SetGlobal("Change_AI_Sword","LOCALS",0)
		Spell(Myself,WIZARD_MORDENKAINENS_SWORD)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_FLESH_TO_STONE)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_FLESH_TO_STONE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_ANIMATE_DEAD)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_ANIMATE_DEAD)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_CONE_OF_COLD)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_CONE_OF_COLD)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_HOLD_PERSON)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	         SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_HOLD_PERSON)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	HaveSpell(WIZARD_SPIDER_SPAWN)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_SPIDER_SPAWN)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_SKULL_TRAP)
	CheckStat(Myself,0,POLYMORPHED)
	NumCreatureLT([ENEMY],3)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(5)
            !StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
            !CheckStat(LastSeenBy(Myself),0,SANCTUARY)
            !CheckStat(LastSeenBy(Myself),0,SHIELDGLOBE)
            HasBounceEffects(LastSeenBy(Myself))
            !CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(2)
		!StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		NumCreatureGT([GOODCUTOFF],1)
	OR(2)
		StateCheck(Myself,STATE_MIRRORIMAGE)
		!Range(LastSeenBy(Myself),12)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_SKULL_TRAP)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHAIN_LIGHTNING)
	DifficultyGT(EASIEST)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_CHAIN_LIGHTNING)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_FLAME_ARROW)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_FLAME_ARROW)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MELF_ACID_ARROW)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_MELF_ACID_ARROW)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_MAGIC_MISSILE)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_MAGIC_MISSILE)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	HaveSpell(WIZARD_CHROMATIC_ORB)
	CheckStat(Myself,0,POLYMORPHED)
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		Spell(LastSeenBy(Myself),WIZARD_CHROMATIC_ORB)
		SetInterrupt(TRUE)
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("RZ_Run_Away_Timer","LOCALS")
	!GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	Range(NearestEnemyOf(Myself),10)
	RandomNumGT(20,5)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("RZ_Run_To_Safety","LOCALS",3)
		SetGlobalTimer("RZ_Run_Away_Timer","LOCALS",12)
		RunAwayFrom(NearestEnemyOf(Myself),45)
		SetInterrupt(TRUE)
END

IF
	Global("Out_of_Spells","LOCALS",0)
	CheckStat(Myself,0,POLYMORPHED)
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(10)
		!StateCheck(NearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),RZ_STATE_DISABLED)
THEN
	RESPONSE #100
	         SetGlobal("RZ_RERUN","LOCALS",1)
END

IF
	GlobalTimerNotExpired("RZ_Run_To_Safety","LOCALS")
THEN
	RESPONSE #100
END

IF
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
        OR(5)
		ActionListEmpty()
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	OR(6)
		!StateCheck(Myself,STATE_INVISIBLE)
		!Global("Out_of_Spells","LOCALS",0)
		GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
        See(NearestEnemyOf(Myself))
        OR(5)
                RandomNumGT(10,1)
                !See(NearestEnemyOf(Myself))
                HasItem("MORSWORD",NearestEnemyOf(Myself))
                HasItem("SW1H33A",NearestEnemyOf(Myself))
                !CheckStat(NearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
        OR(5)
                RandomNumGT(20,2)
                !See(SecondNearestEnemyOf(Myself))
                HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
                HasItem("SW1H33A",SecondNearestEnemyOf(Myself))
                !CheckStat(SecondNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(SecondNearestEnemyOf(Myself),STATE_INVISIBLE)
        OR(10)
		RandomNumGT(2,1)
		!Heard([ENEMY],101)
		Range(LastHeardBy(Myself),0)
		!See(LastAttackerOf(LastHeardBy(Myself)))
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,STONESKINS)
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_MIRRORIMAGE)
		!Range(LastAttackerOf(LastHeardBy(Myself)),20)
		HasItem("MORSWORD",LastAttackerOf(LastHeardBy(Myself)))
                HasItem("SW1H33A",LastAttackerOf(LastHeardBy(Myself)))
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,SANCTUARY)
                StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_INVISIBLE)
	OR(8)
		RandomNumGT(6,3)
		!See(LastAttackerOf(Myself))
		!Range(LastAttackerOf(Myself),10)
		HasItem("MORSWORD",LastAttackerOf(Myself))
                HasItem("SW1H33A",LastAttackerOf(Myself))
		!CheckStat(LastAttackerOf(Myself),0,STONESKINS)
		StateCheck(LastAttackerOf(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastAttackerOf(Myself),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
                StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
        OR(7)
	        RandomNumGT(4,1)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
		!StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(4,1)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(4,1)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(8,2)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(8,2)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(8,2)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(12,3)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_MIRRORIMAGE)
		!StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(12,3)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(12,3)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(16,4)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_MIRRORIMAGE)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(16,4)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(16,4)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(24,6)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_MIRRORIMAGE)
		!StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(24,6)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(24,6)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(28,7)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_MIRRORIMAGE)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(28,7)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(28,7)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(32,8)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_MIRRORIMAGE)
		!StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(32,8)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(32,8)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_MIRRORIMAGE)
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(36,9)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_MIRRORIMAGE)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(36,9)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(7)
	        RandomNumGT(36,9)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(40,10)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		!StateCheck(MostDamagedOf([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(40,10)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		CheckStat(MostDamagedOf([PC]),0,HELD)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(40,10)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(44,11)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		!StateCheck([PC],RZ_STATE_VULNERABLE)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(7)
		RandomNumGT(44,11)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],0,HELD)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(7)
		RandomNumGT(44,11)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		CheckStat([PC],0,CasterHold)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(7)
		RandomNumGT(48,12)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		!StateCheck(SecondNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(48,12)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),0,HELD)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(48,12)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SecondNearest([PC]),0,CasterHold)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(52,13)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		!StateCheck(ThirdNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(52,13)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),0,HELD)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(7)
        	RandomNumGT(52,13)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(ThirdNearest([PC]),0,CasterHold)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(56,14)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		!StateCheck(FourthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(56,14)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),0,HELD)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(56,14)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FourthNearest([PC]),0,CasterHold)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(60,15)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		!StateCheck(FifthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(60,15)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),0,HELD)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(60,15)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(FifthNearest([PC]),0,CasterHold)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(64,16)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		!StateCheck(SixthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(64,16)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),0,HELD)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(64,16)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		CheckStat(SixthNearest([PC]),0,CasterHold)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
        OR(7)
		RandomNumGT(68,17)
		!See([GOODCUTOFF.0.0.MAGE_ALL])
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_MIRRORIMAGE)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
        OR(7)
		RandomNumGT(72,18)
		!See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
        OR(7)
		RandomNumGT(76,19)
		!See([GOODCUTOFF.0.0.SORCERER])
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_MIRRORIMAGE)
		StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
        OR(7)
		RandomNumGT(80,20)
		!See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
        OR(7)
		RandomNumGT(84,21)
		!See([GOODCUTOFF.0.0.DRUID_ALL])
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_MIRRORIMAGE)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
        OR(7)
		RandomNumGT(88,22)
		!See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
        OR(7)
		RandomNumGT(92,23)
		!See([GOODCUTOFF.0.0.CLERIC_RANGER])
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_MIRRORIMAGE)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
        OR(7)
		RandomNumGT(96,24)
		!See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(104,26)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),STATE_MIRRORIMAGE)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,25)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],STATE_MIRRORIMAGE)
		StateCheck([PC],RZ_STATE_DISABLED)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,46)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),STATE_MIRRORIMAGE)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,63)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),STATE_MIRRORIMAGE)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,76)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),STATE_MIRRORIMAGE)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,85)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),STATE_MIRRORIMAGE)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(100,90)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),STATE_MIRRORIMAGE)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(9)
		RandomNumGT(14,7)
		!Heard([ENEMY],101)
		Range(LastHeardBy(Myself),0)
		!See(LastAttackerOf(LastHeardBy(Myself)))
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,STONESKINS)
		!Range(LastAttackerOf(LastHeardBy(Myself)),20)
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,SANCTUARY)
                StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_INVISIBLE)
	OR(7)
		RandomNumGT(18,9)
		!See(LastAttackerOf(Myself))
		!Range(LastAttackerOf(Myself),10)
		!CheckStat(LastAttackerOf(Myself),0,STONESKINS)
		StateCheck(LastAttackerOf(Myself),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
                StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
        OR(6)
	        RandomNumGT(108,27)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		!StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(108,27)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(108,27)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(112,28)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(112,28)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(112,28)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(116,29)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		!StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(116,29)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(116,29)
                !See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(120,30)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(120,30)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(120,30)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(124,31)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		!StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(124,31)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(124,31)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(128,32)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(128,32)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(128,32)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(132,33)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		!StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(132,33)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(132,33)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(136,34)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(136,34)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(6)
	        RandomNumGT(136,34)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(140,35)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		!StateCheck(MostDamagedOf([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(140,35)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		CheckStat(MostDamagedOf([PC]),0,HELD)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(140,35)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(144,36)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		!StateCheck([PC],RZ_STATE_VULNERABLE)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(6)
		RandomNumGT(144,36)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,HELD)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(6)
		RandomNumGT(144,36)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		CheckStat([PC],0,CasterHold)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(6)
		RandomNumGT(148,37)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		!StateCheck(SecondNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(148,37)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,HELD)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(148,37)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		CheckStat(SecondNearest([PC]),0,CasterHold)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(152,38)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		!StateCheck(ThirdNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(152,38)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,HELD)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(152,38)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		CheckStat(ThirdNearest([PC]),0,CasterHold)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(156,39)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		!StateCheck(FourthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(156,39)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,HELD)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(156,39)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		CheckStat(FourthNearest([PC]),0,CasterHold)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(160,40)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		!StateCheck(FifthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(160,40)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,HELD)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(160,40)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		CheckStat(FifthNearest([PC]),0,CasterHold)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(164,41)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		!StateCheck(SixthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(164,41)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,HELD)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(164,41)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		CheckStat(SixthNearest([PC]),0,CasterHold)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
        OR(6)
		RandomNumGT(168,42)
		!See([GOODCUTOFF.0.0.MAGE_ALL])
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
        OR(6)
		RandomNumGT(172,43)
		!See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
        OR(6)
		RandomNumGT(176,44)
		!See([GOODCUTOFF.0.0.SORCERER])
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
        OR(6)
		RandomNumGT(180,45)
		!See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
        OR(6)
		RandomNumGT(184,46)
		!See([GOODCUTOFF.0.0.DRUID_ALL])
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
        OR(6)
		RandomNumGT(188,47)
		!See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
        OR(6)
		RandomNumGT(192,48)
		!See([GOODCUTOFF.0.0.CLERIC_RANGER])
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,STONESKINS)
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
        OR(6)
		RandomNumGT(196,49)
		!See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(204,51)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,STONESKINS)
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,50)
		!See([PC])
		!CheckStat([PC],0,STONESKINS)
		StateCheck([PC],RZ_STATE_DISABLED)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,92)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,STONESKINS)
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,126)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,STONESKINS)
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,152)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,STONESKINS)
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,170)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,STONESKINS)
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(200,180)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,STONESKINS)
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(8)
		RandomNumGT(22,11)
		!Heard([ENEMY],101)
		Range(LastHeardBy(Myself),0)
		!See(LastAttackerOf(LastHeardBy(Myself)))
		!Range(LastAttackerOf(LastHeardBy(Myself)),20)
		StateCheck(LastAttackerOf(LastHeardBy(Myself)),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,SANCTUARY)
                StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(26,13)
		!See(LastAttackerOf(Myself))
		!Range(LastAttackerOf(Myself),10)
		StateCheck(LastAttackerOf(Myself),RZ_STATE_DISABLED)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
                StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
        OR(5)
	        RandomNumGT(208,52)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
		!StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(208,52)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(208,52)
                !See([GOODCUTOFF.0.0.MAGE_ALL])
		CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(212,53)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(212,53)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(212,53)
                !See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(216,54)
                !See([GOODCUTOFF.0.0.SORCERER])
		!StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(216,54)
                !See([GOODCUTOFF.0.0.SORCERER])
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(216,54)
                !See([GOODCUTOFF.0.0.SORCERER])
		CheckStat([GOODCUTOFF.0.0.SORCERER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(220,55)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(220,55)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(220,55)
                !See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(224,56)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
		!StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(224,56)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(224,56)
                !See([GOODCUTOFF.0.0.DRUID_ALL])
		CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(228,57)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(228,57)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(228,57)
                !See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(232,58)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
		!StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_VULNERABLE)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(232,58)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,HELD)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(232,58)
                !See([GOODCUTOFF.0.0.CLERIC_RANGER])
		CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,CasterHold)
		!CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(236,59)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
		!StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(236,59)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,STONESKINS)
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,HELD)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(5)
	        RandomNumGT(236,59)
                !See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
		CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,CasterHold)
		!CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(240,60)
		!See(MostDamagedOf([PC]))
		!StateCheck(MostDamagedOf([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(240,60)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,HELD)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(240,60)
		!See(MostDamagedOf([PC]))
		CheckStat(MostDamagedOf([PC]),0,CasterHold)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(244,61)
		!See([PC])
		!StateCheck([PC],RZ_STATE_VULNERABLE)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(5)
		RandomNumGT(244,61)
		!See([PC])
		CheckStat([PC],0,HELD)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(5)
		RandomNumGT(244,61)
		!See([PC])
		CheckStat([PC],0,CasterHold)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(5)
		RandomNumGT(248,62)
		!See(SecondNearest([PC]))
		!StateCheck(SecondNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(248,62)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,HELD)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(248,62)
		!See(SecondNearest([PC]))
		CheckStat(SecondNearest([PC]),0,CasterHold)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(252,63)
		!See(ThirdNearest([PC]))
		!StateCheck(ThirdNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(252,63)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,HELD)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(252,63)
		!See(ThirdNearest([PC]))
		CheckStat(ThirdNearest([PC]),0,CasterHold)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(256,64)
		!See(FourthNearest([PC]))
		!StateCheck(FourthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(256,64)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,HELD)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(256,64)
		!See(FourthNearest([PC]))
		CheckStat(FourthNearest([PC]),0,CasterHold)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(260,65)
		!See(FifthNearest([PC]))
		!StateCheck(FifthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(260,65)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,HELD)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(260,65)
		!See(FifthNearest([PC]))
		CheckStat(FifthNearest([PC]),0,CasterHold)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(264,66)
		!See(SixthNearest([PC]))
		!StateCheck(SixthNearest([PC]),RZ_STATE_VULNERABLE)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(264,66)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,HELD)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(264,66)
		!See(SixthNearest([PC]))
		CheckStat(SixthNearest([PC]),0,CasterHold)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
        OR(5)
		RandomNumGT(268,67)
		!See([GOODCUTOFF.0.0.MAGE_ALL])
		StateCheck([GOODCUTOFF.0.0.MAGE_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
        OR(5)
		RandomNumGT(272,68)
		!See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
		StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
        OR(5)
		RandomNumGT(276,69)
		!See([GOODCUTOFF.0.0.SORCERER])
		StateCheck([GOODCUTOFF.0.0.SORCERER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
        OR(5)
		RandomNumGT(280,70)
		!See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
		StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
        OR(5)
		RandomNumGT(284,71)
		!See([GOODCUTOFF.0.0.DRUID_ALL])
		StateCheck([GOODCUTOFF.0.0.DRUID_ALL],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
        OR(5)
		RandomNumGT(288,72)
		!See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
		StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
        OR(5)
		RandomNumGT(292,73)
		!See([GOODCUTOFF.0.0.CLERIC_RANGER])
		StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],RZ_STATE_DISABLED)
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
        OR(5)
		RandomNumGT(296,74)
		!See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
		StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),RZ_STATE_DISABLED)
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(304,76)
		!See(MostDamagedOf([PC]))
		StateCheck(MostDamagedOf([PC]),RZ_STATE_DISABLED)
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,75)
		!See([PC])
		StateCheck([PC],RZ_STATE_DISABLED)
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,138)
		!See(SecondNearest([PC]))
		StateCheck(SecondNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,189)
		!See(ThirdNearest([PC]))
		StateCheck(ThirdNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,228)
		!See(FourthNearest([PC]))
		StateCheck(FourthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,255)
		!See(FifthNearest([PC]))
		StateCheck(FifthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(5)
		RandomNumGT(300,270)
		!See(SixthNearest([PC]))
		StateCheck(SixthNearest([PC]),RZ_STATE_DISABLED)
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
        OR(8)
		RandomNumGT(30,15)
		!Heard([ENEMY],101)
		Range(LastHeardBy(Myself),0)
		!See(LastAttackerOf(LastHeardBy(Myself)))
		!Range(LastAttackerOf(LastHeardBy(Myself)),20)
		!CheckStat(LastAttackerOf(LastHeardBy(Myself)),0,SANCTUARY)
                StateCheck(LastAttackerOf(LastHeardBy(Myself)),STATE_INVISIBLE)
	OR(6)
		RandomNumGT(34,17)
		!See(LastAttackerOf(Myself))
		!Range(LastAttackerOf(Myself),10)
		!CheckStat(LastAttackerOf(Myself),0,SANCTUARY)
                StateCheck(LastAttackerOf(Myself),STATE_INVISIBLE)
        OR(4)
		RandomNumGT(308,77)
		!See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
        OR(4)
		RandomNumGT(312,78)
		!See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
        OR(4)
		RandomNumGT(316,79)
		!See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
        OR(4)
		RandomNumGT(320,80)
		!See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
        OR(4)
		RandomNumGT(324,81)
		!See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
        OR(4)
		RandomNumGT(328,82)
		!See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
        OR(4)
		RandomNumGT(332,83)
		!See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
        OR(4)
		RandomNumGT(336,84)
		!See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
        OR(4)
		RandomNumGT(340,85)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
                StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,100)
		!See([PC])
		!CheckStat([PC],0,SANCTUARY)
                StateCheck([PC],STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,184)
		!See(SecondNearest([PC]))
		!CheckStat(SecondNearest([PC]),0,SANCTUARY)
                StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,252)
		!See(ThirdNearest([PC]))
		!CheckStat(ThirdNearest([PC]),0,SANCTUARY)
                StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,304)
		!See(FourthNearest([PC]))
		!CheckStat(FourthNearest([PC]),0,SANCTUARY)
                StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,340)
		!See(FifthNearest([PC]))
		!CheckStat(FifthNearest([PC]),0,SANCTUARY)
                StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
	OR(4)
		RandomNumGT(400,360)
		!See(SixthNearest([PC]))
		!CheckStat(SixthNearest([PC]),0,SANCTUARY)
                StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
        OR(3)
		!See([GOODCUTOFF.0.0.MAGE_ALL])
                !CheckStat([GOODCUTOFF.0.0.MAGE_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.MAGE_ALL],STATE_INVISIBLE)
        OR(3)
		!See(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.MAGE_ALL]),STATE_INVISIBLE)
        OR(3)
		!See([GOODCUTOFF.0.0.SORCERER])
                !CheckStat([GOODCUTOFF.0.0.SORCERER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.SORCERER],STATE_INVISIBLE)
        OR(3)
		!See(SecondNearest([GOODCUTOFF.0.0.SORCERER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.SORCERER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.SORCERER]),STATE_INVISIBLE)
        OR(3)
		!See([GOODCUTOFF.0.0.DRUID_ALL])
                !CheckStat([GOODCUTOFF.0.0.DRUID_ALL],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.DRUID_ALL],STATE_INVISIBLE)
        OR(3)
		!See(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.DRUID_ALL]),STATE_INVISIBLE)
        OR(3)
		!See([GOODCUTOFF.0.0.CLERIC_RANGER])
                !CheckStat([GOODCUTOFF.0.0.CLERIC_RANGER],0,SANCTUARY)
                StateCheck([GOODCUTOFF.0.0.CLERIC_RANGER],STATE_INVISIBLE)
        OR(3)
		!See(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]))
                !CheckStat(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),0,SANCTUARY)
                StateCheck(SecondNearest([GOODCUTOFF.0.0.CLERIC_RANGER]),STATE_INVISIBLE)
        OR(3)
		!See(MostDamagedOf([PC]))
		!CheckStat(MostDamagedOf([PC]),0,SANCTUARY)
              StateCheck(MostDamagedOf([PC]),STATE_INVISIBLE)
        OR(3)
	     !See([PC])
	     !CheckStat([PC],0,SANCTUARY)
              StateCheck([PC],STATE_INVISIBLE)
      OR(3)
	     !See(SecondNearest([PC]))
	     !CheckStat(SecondNearest([PC]),0,SANCTUARY)
              StateCheck(SecondNearest([PC]),STATE_INVISIBLE)
      OR(3)
	     !See(ThirdNearest([PC]))
	     !CheckStat(ThirdNearest([PC]),0,SANCTUARY)
              StateCheck(ThirdNearest([PC]),STATE_INVISIBLE)
      OR(3)
	     !See(FourthNearest([PC]))
	     !CheckStat(FourthNearest([PC]),0,SANCTUARY)
              StateCheck(FourthNearest([PC]),STATE_INVISIBLE)
      OR(3)
	     !See(FifthNearest([PC]))
	     !CheckStat(FifthNearest([PC]),0,SANCTUARY)
              StateCheck(FifthNearest([PC]),STATE_INVISIBLE)
      OR(3)
	     !See(SixthNearest([PC]))
	     !CheckStat(SixthNearest([PC]),0,SANCTUARY)
              StateCheck(SixthNearest([PC]),STATE_INVISIBLE)
	OR(5)
                !See(NearestEnemyOf(Myself))
                HasItem("MORSWORD",NearestEnemyOf(Myself))
                HasItem("SW1H33A",NearestEnemyOf(Myself))
                !CheckStat(NearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(NearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(SecondNearestEnemyOf(Myself))
                HasItem("MORSWORD",SecondNearestEnemyOf(Myself))
                HasItem("SW1H33A",SecondNearestEnemyOf(Myself))
                !CheckStat(SecondNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(SecondNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(ThirdNearestEnemyOf(Myself))
                HasItem("MORSWORD",ThirdNearestEnemyOf(Myself))
                HasItem("SW1H33A",ThirdNearestEnemyOf(Myself))
                !CheckStat(ThirdNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(ThirdNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(FourthNearestEnemyOf(Myself))
                HasItem("MORSWORD",FourthNearestEnemyOf(Myself))
                HasItem("SW1H33A",FourthNearestEnemyOf(Myself))
                !CheckStat(FourthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(FourthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(FifthNearestEnemyOf(Myself))
                HasItem("MORSWORD",FifthNearestEnemyOf(Myself))
                HasItem("SW1H33A",FifthNearestEnemyOf(Myself))
                !CheckStat(FifthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(FifthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(SixthNearestEnemyOf(Myself))
                HasItem("MORSWORD",SixthNearestEnemyOf(Myself))
                HasItem("SW1H33A",SixthNearestEnemyOf(Myself))
                !CheckStat(SixthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(SixthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(SeventhNearestEnemyOf(Myself))
                HasItem("MORSWORD",SeventhNearestEnemyOf(Myself))
                HasItem("SW1H33A",SeventhNearestEnemyOf(Myself))
                !CheckStat(SeventhNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(SeventhNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(EighthNearestEnemyOf(Myself))
                HasItem("MORSWORD",EighthNearestEnemyOf(Myself))
                HasItem("SW1H33A",EighthNearestEnemyOf(Myself))
                !CheckStat(EighthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(EighthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(NinthNearestEnemyOf(Myself))
                HasItem("MORSWORD",NinthNearestEnemyOf(Myself))
                HasItem("SW1H33A",NinthNearestEnemyOf(Myself))
                !CheckStat(NinthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(NinthNearestEnemyOf(Myself),STATE_INVISIBLE)
	OR(5)
                !See(TenthNearestEnemyOf(Myself))
                HasItem("MORSWORD",TenthNearestEnemyOf(Myself))
                HasItem("SW1H33A",TenthNearestEnemyOf(Myself))
                !CheckStat(TenthNearestEnemyOf(Myself),0,SANCTUARY)
                StateCheck(TenthNearestEnemyOf(Myself),STATE_INVISIBLE)
	See(Myself)
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	OR(2)
	     !CheckStatLT(Myself,34,SPELLFAILUREMAGE)
             !GlobalTimerNotExpired("Use_Item_Timer","LOCALS")
        GlobalLT("Staff_of_Power_Stun","LOCALS",10)
        DifficultyGT(EASY)
	CheckStat(Myself,0,POLYMORPHED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Use_Item_Timer","LOCALS",30)
		IncrementGlobal("Staff_of_Power_Stun","LOCALS",1)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		ForceSpellRES("VA#STAF1",LastSeenBy(Myself))
		SetInterrupt(TRUE)
END

IF
	!GlobalTimerNotExpired("Action_Timer","LOCALS")
	OR(2)
	     !CheckStatLT(Myself,34,SPELLFAILUREMAGE)
             !GlobalTimerNotExpired("Use_Item_Timer","LOCALS")
	HasItem("wand04",Myself)
	CheckStat(Myself,0,POLYMORPHED)
	See(LastSeenBy(Myself))
	CheckStat(LastSeenBy(Myself),0,SCRIPTINGSTATE3)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),RZ_STATE_DISABLED)
	OR(3)
		!GlobalTimerNotExpired("Death_Spell","LOCALS")
		Allegiance(LastSeenBy(Myself),PC)
		LevelGT(LastSeenBy(Myself),8)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
	        SetInterrupt(FALSE)
		SetGlobalTimer("Action_Timer","LOCALS",6)
		SetGlobalTimer("Use_Item_Timer","LOCALS",30)
		DestroyItem("RZSEEINV")
		EquipMostDamagingMelee()
		UseItem("wand04",LastSeenBy(Myself))
		SetInterrupt(TRUE)
END

IF
	!RandomNum(21,6)
	HasItem("dart05",Myself)
	OR(5)
		ActionListEmpty()
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	OR(7)
		!StateCheck(Myself,STATE_INVISIBLE)
		!Global("Out_of_Spells","LOCALS",0)
		GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	        !Range(LastSeenBy(Myself),8)
	See(LastSeenBy(Myself))
	!Range(LastSeenBy(Myself),6)
	OR(2)
	    !HasItem("MORSWORD",LastSeenBy(Myself))
	    CheckStatLT(LastSeenBy(Myself),100,RESISTSLASHING)
        OR(2)
            !HasItem("SW1H33A",LastSeenBy(Myself))
            CheckStatLT(LastSeenBy(Myself),100,RESISTSLASHING)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		EquipRanged()
		AttackReevaluate(LastSeenBy(Myself),45)
END

IF
	!RandomNum(21,6)
	OR(5)
		ActionListEmpty()
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	OR(6)
		!StateCheck(Myself,STATE_INVISIBLE)
		!Global("Out_of_Spells","LOCALS",0)
		GlobalTimerNotExpired("Time_Stop_Timer","LOCALS")
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	See(LastSeenBy(Myself))
	OR(2)
	    !HasItem("MORSWORD",LastSeenBy(Myself))
	    CheckStatLT(LastSeenBy(Myself),100,RESISTSLASHING)
        OR(2)
            !HasItem("SW1H33A",LastSeenBy(Myself))
            CheckStatLT(LastSeenBy(Myself),100,RESISTSLASHING)
	OR(8)
		Range(LastSeenBy(Myself),6)
		!Global("Out_of_Spells","LOCALS",0)
		StateCheck(LastSeenBy(Myself),RZ_STATE_VULNERABLE)
		!CheckStat(Myself,0,POLYMORPHED)
		!CheckStat(LastSeenBy(Myself),0,CasterHold)
	        !CheckStat(LastSeenBy(Myself),0,HELD)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	OR(6)
		NumCreature([GOODCUTOFF],1)
                Range(LastSeenBy(Myself),15)
                !CheckStat(Myself,0,POLYMORPHED)
		!Global("Out_of_Spells","LOCALS",0)
		!CheckStatLT(Myself,34,SPELLFAILUREMAGE)
	        StateCheck(Myself,STATE_SILENCED)
	CheckStat(LastSeenBy(Myself),0,SANCTUARY)
	!StateCheck(LastSeenBy(Myself),STATE_INVISIBLE)
	!Allegiance(LastSeenBy(Myself),ENEMY)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		AttackReevaluate(LastSeenBy(Myself),45)
END

IF
	ActionListEmpty()
THEN
	RESPONSE #100
		RandomWalk()
END